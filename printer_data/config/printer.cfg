[respond]

#  Octopus Pro boards STM32H723.  Select the appropriate micro-controller in "make
# menuconfig" and select "Enable low-level configuration options". For
#  For STM32H723 boards use a "128KiB bootloader" and a "25Mhz crystal"
# See docs/Config_Reference.md for a description of parameters.
[exclude_object]
[include mainsail.cfg]
[include config/fan.cfg]
[include config/stepper.cfg]
[include config/led.cfg]
[include config/wiper.cfg]
[include macros/macro.cfg]


[virtual_sdcard]
path: /home/pi/printer_data/gcodes
on_error_gcode: CANCEL_PRINT
[respond]   #activate messages
[gcode_arcs]  #activate round corner
resolution: 0.1
[force_move]
enable_force_move: True
[gcode_macro FORCE]
gcode:
      SET_KINEMATIC_POSITION X=105 Y=94 Z=20
[shaketune]
# result_folder: ~/printer_data/config/ShakeTune_results
# number_of_results_to_keep: 10
# keep_raw_data: False
# show_macros_in_webui: True
# timeout: 60
# measurements_chunk_size: 2
# max_freq: 200
# dpi: 300



[gcode_macro _CLIENT_VARIABLE]
variable_use_custom_pos   : True ; use custom park coordinates for x,y [True/False]
variable_custom_park_x    : 10.0   ; custom x position; value must be within your defined min and max of X
variable_custom_park_y    : 10.0   ; custom y position; value must be within your defined min and max of Y
variable_custom_park_dz   : 25.0   ; custom dz value; the value in mm to lift the nozzle when move to park position
variable_retract          : 0.50   ; the value to retract while PAUSE
variable_cancel_retract   : 0.80   ; the value to retract while CANCEL_PRINT
variable_speed_retract    : 35.0  ; retract speed in mm/s
variable_unretract        : 0.80   ; the value to unretract while RESUME
variable_speed_unretract  : 35.0  ; unretract speed in mm/s
variable_speed_hop        : 15.0  ; z move speed in mm/s
variable_speed_move       : 100.0 ; move speed in mm/s
variable_park_at_cancel   : True ; allow to move the toolhead to park while execute CANCEL_PRINT [True/False]
variable_park_at_cancel_x : 10  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
variable_park_at_cancel_y : 10  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
## !!! Caution [firmware_retraction] must be defined in the printer.cfg if you set use_fw_retract: True !!!
variable_use_fw_retract   : True ; use fw_retraction instead of the manual version [True/False]
variable_idle_timeout     : 0     ; time in sec until idle_timeout kicks in. Value 0 means that no value will be set or restored
variable_runout_sensor    : "filament_switch_sensor fs_extruder"    ; If a sensor is defined, it will be used to cancel the execution of RESUME in case no filament is detected.
##                                   Specify the config name of the runout sensor e.g "filament_switch_sensor runout". Hint use the same as in your printer.cfg
## !!! Custom macros, please use with care and review the section of the corresponding macro.
## These macros are for simple operations like setting a status LED. Please make sure your macro does not interfere with the basic macro functions.
## Only  single line commands are supported, please create a macro if you need more than one command.
#variable_user_pause_macro : ""    ; Everything insight the "" will be executed after the klipper base pause (PAUSE_BASE) function
#variable_user_resume_macro: ""    ; Everything insight the "" will be executed before the klipper base resume (RESUME_BASE) function
#variable_user_cancel_macro: ""    ; Everything insight the "" will be executed before the klipper base cancel (CANCEL_PRINT_BASE) function
gcode:

########################
########################
### Printer
########################

[printer]
kinematics: corexy
max_velocity: 600
max_accel: 60000
minimum_cruise_ratio: 0.7
max_z_velocity: 30
max_z_accel: 2000
square_corner_velocity: 20

#[input_shaper]
#shaper_freq_x: 132.6
#shaper_type_x: ei
#damping_ratio_x: 0.043
#shaper_freq_y: 92.0
#shaper_type_y: ei
#damping_ratio_y: 0.041

[mcu host]
serial: /tmp/klipper_host_mcu

[mcu]
canbus_uuid: 59469bda118c

[mcu EBBCan]
canbus_uuid: 7923f36815fd

[mcu scanner]
canbus_uuid: 7dd159b0a935

[temperature_sensor Octopus]
sensor_type: temperature_mcu
max_temp: 100

[temperature_sensor raspberry_pi_4B]
sensor_type: temperature_host
min_temp: 10
max_temp: 100 

#[adxl345]
#cs_pin: EBBCan: PB12
#spi_software_sclk_pin: EBBCan: PB10
#spi_software_mosi_pin: EBBCan: PB11
#spi_software_miso_pin: EBBCan: PB2
#axes_map: x,y,z


########################
########################
### Extruder
########################
[extruder]
step_pin: EBBCan: PD0
dir_pin: !EBBCan: PD1
enable_pin: !EBBCan: PD2
microsteps: 16
full_steps_per_rotation: 200
rotation_distance: 22 
Gear_ratio: 50:10
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: EBBCan: PB13
#control: pid
#pid_Kp: 23.216 
#pid_Ki: 1.629 
#pid_Kd: 82.712
min_temp: 0
max_temp: 450

sensor_type:MAX31865
sensor_pin: EBBCan: PA4
spi_bus: spi1
rtd_nominal_r: 1000
rtd_reference_r: 4300
rtd_num_of_wires: 2

max_extrude_only_distance: 250.0
max_extrude_cross_section: 250
#pressure_advance: 0.02
#pressure_advance_smooth_time: 0.03

[tmc2209 extruder]
uart_pin: EBBCan: PA15
run_current: 0.85
stealthchop_threshold: 0

[firmware_retraction]
retract_length: 0.3
retract_speed: 85
unretract_speed: 85

########################
########################
### Heatbed
########################

[heater_bed]
heater_pin: PF5
sensor_pin: PB1 # TB
sensor_type: ATC Semitec 104GT-2
min_temp: 0
max_temp: 130
#control: pid
#pid_kp: 54.122
#pid_ki: 2.864
#pid_kd: 255.727
max_power: 0.7

########################
########################
### Cartographer
########################

[scanner]    
mcu: scanner 
x_offset: 0
y_offset: 23    
backlash_comp: -0.00121
sensor: cartographer
sensor_alt: carto   
mesh_runs: 2
samples: 10
samples_tolerance_retries: 8
scanner_touch_sample_count:6
scanner_touch_max_retries:15
scanner_touch_accel: 100
scanner_touch_max_speed: 5 #10

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

#[lis2dw]
#cs_pin: scanner:PA3
#spi_bus: spi1

#[resonance_tester]
#accel_chip: lis2dw
#probe_points:
#    115, 115, 20
########################
########################
### Bed Mesh
########################
[safe_z_home]
home_xy_position: 105,94
speed: 200
z_hop: 10
z_hop_speed: 20.0



[bed_mesh]
speed: 400
horizontal_move_z: 5
mesh_min: 14, 23
mesh_max: 204, 195
mesh_pps: 0,0
move_check_distance: 3
probe_count: 30,30
algorithm: bicubic
zero_reference_position: 105,94

[screws_tilt_adjust]
screw1: 27, 0
screw1_name: vorne links
screw2: 27, 175
screw2_name: hinten links
screw3: 196, 175
screw3_name: hinten rechts
screw4: 196, 0
screw4_name: vorne rechts
speed: 200
horizontal_move_z: 5
screw_thread: CW-M4


[axis_twist_compensation]
speed: 5
horizontal_move_z: 5
calibrate_start_x: 15
calibrate_end_x: 195
calibrate_y: 112.5


#[neopixel my_neopixel_1]
#pin: PE10

#[neopixel my_neopixel_2]
#pin: PE9

########################
########################
### Motor Sync
########################

[motors_sync]
axes: x,y
accel_chip: lis2dw
#chip_filter: disabled
#    Filter type for data from the accelerometer: 'median' works well in
#    most cases, but some particularly noisy printers (fans, etc.) may
#    require a more powerful filter - 'kalman'. On lis2dw filters disabled
microsteps: 16
#sync_method: default
#    Methods for synchronizing two axes on interconnected kinematics:
#    'alternately' - the axes calibrated alternately, step by step. (default)
#    'synchronous' - the axes calibrated depending on their magnitude,
#    trying to keep it at the same level.
#    Methods for synchronizing axis/axes on NOT-interconnected kinematics:
#    'sequential' - axes are calibrated sequentially. (default)
#model: linear
#    Model of the dependence of the microstep displacement of a stepper
#    motor on the magnitude of the measured oscillations. Supported
#    models: linear, quadratic, power, root, hyperbolic, exponential.
#model_coeffs: 20000, 0
#max_step_size: 3
#axes_steps_diff: 4
#retry_tolerance: 0
#retries: 0
head_fan: hotend_fan

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# pid_kp = 45.826
#*# pid_ki = 2.122
#*# pid_kd = 247.461
#*# control = pid
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 23.200
#*# pid_ki = 1.487
#*# pid_kd = 90.488
#*#
#*# [motors_sync]
#*# steps_model_x = power,
#*# 	7068.38961107219,
#*# 	1.1378344505231288
#*# steps_model_y = power,
#*# 	7068.38961107219,
#*# 	1.1378344505231288
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 1500
#*# scanner_touch_speed = 2
#*# scanner_touch_z_offset = 0.255
#*#
#*# [scanner model default]
#*# model_coef = 1.4940003682020517,
#*# 	1.8351774003039487,
#*# 	0.7031867566267228,
#*# 	0.04136717878887422,
#*# 	0.7186562832504952,
#*# 	1.741608496727749,
#*# 	-0.9275188438419594,
#*# 	-2.4451985008541803,
#*# 	0.65910692375751,
#*# 	1.2766093674436259
#*# model_domain = 3.1888609685171073e-07,3.2982518625547614e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 51.671051
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.3
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.079482, -0.081108, -0.081906, -0.082796, -0.085167, -0.083805, -0.081693, -0.077853, -0.076250, -0.073697, -0.071718, -0.069400, -0.065963, -0.062405, -0.057564, -0.052411, -0.045446, -0.040353, -0.035375, -0.027885, -0.020937, -0.012174, -0.005651, -0.003043, 0.006724, 0.011137, 0.017331, 0.025743, 0.020764, 0.034614
#*# 	-0.064431, -0.074873, -0.067027, -0.065774, -0.066798, -0.065784, -0.072154, -0.064605, -0.061558, -0.056530, -0.055498, -0.058985, -0.049892, -0.048492, -0.040540, -0.039454, -0.036642, -0.028225, -0.022866, -0.009278, -0.006281, -0.000777, 0.009252, 0.012537, 0.024280, 0.024743, 0.028690, 0.038799, 0.039715, 0.042313
#*# 	-0.051971, -0.061405, -0.062835, -0.064836, -0.065755, -0.058793, -0.064341, -0.062191, -0.059061, -0.058287, -0.050070, -0.053655, -0.049462, -0.045406, -0.041685, -0.033615, -0.029485, -0.025044, -0.019785, -0.014199, -0.002069, 0.006094, 0.011520, 0.014027, 0.019273, 0.030982, 0.036154, 0.038160, 0.034256, 0.043140
#*# 	-0.056158, -0.059069, -0.055464, -0.055259, -0.057836, -0.062484, -0.061192, -0.054578, -0.053278, -0.049486, -0.054534, -0.044703, -0.040598, -0.039840, -0.032256, -0.035709, -0.026888, -0.020781, -0.017108, -0.001651, -0.001728, 0.008319, 0.013641, 0.018512, 0.029171, 0.029544, 0.033920, 0.041404, 0.045380, 0.050705
#*# 	-0.041886, -0.051014, -0.052303, -0.055302, -0.056373, -0.049473, -0.054600, -0.053028, -0.050986, -0.050050, -0.041926, -0.043886, -0.039550, -0.036188, -0.034596, -0.025756, -0.023429, -0.017680, -0.010154, -0.007009, 0.006054, 0.011374, 0.018031, 0.024524, 0.026577, 0.037549, 0.039999, 0.044391, 0.051561, 0.048539
#*# 	-0.045920, -0.041948, -0.043729, -0.044147, -0.045018, -0.050940, -0.045502, -0.046657, -0.044988, -0.040595, -0.044321, -0.035312, -0.034835, -0.031634, -0.024338, -0.026448, -0.017623, -0.015854, -0.009018, 0.004999, 0.004521, 0.014635, 0.018571, 0.024958, 0.037107, 0.035702, 0.041525, 0.045338, 0.055791, 0.056860
#*# 	-0.031117, -0.028408, -0.038493, -0.041470, -0.041878, -0.036011, -0.037125, -0.043061, -0.040291, -0.040218, -0.032560, -0.032453, -0.031074, -0.026899, -0.024753, -0.016309, -0.012159, -0.007990, -0.001091, 0.000710, 0.011419, 0.017674, 0.022644, 0.029491, 0.034152, 0.042657, 0.045548, 0.048112, 0.057387, 0.051962
#*# 	-0.031055, -0.028517, -0.030616, -0.031272, -0.032285, -0.037735, -0.033537, -0.036004, -0.032375, -0.030288, -0.034372, -0.026241, -0.024709, -0.018447, -0.015539, -0.015219, -0.006538, -0.006673, 0.004178, 0.007075, 0.010688, 0.020161, 0.023035, 0.033202, 0.036603, 0.039135, 0.041716, 0.046801, 0.057050, 0.054644
#*# 	-0.023063, -0.018502, -0.028350, -0.030260, -0.029633, -0.031315, -0.025198, -0.030138, -0.026595, -0.027865, -0.027305, -0.018991, -0.020715, -0.015052, -0.014303, -0.007797, -0.002409, 0.000321, 0.006959, 0.007340, 0.016365, 0.024033, 0.026482, 0.033812, 0.031665, 0.042040, 0.045280, 0.049026, 0.053601, 0.047734
#*# 	-0.018494, -0.019042, -0.023472, -0.024481, -0.025744, -0.029440, -0.022513, -0.024183, -0.018776, -0.022707, -0.020401, -0.014949, -0.016003, -0.007868, -0.008629, -0.003505, 0.001945, 0.002460, 0.013101, 0.013307, 0.020051, 0.026162, 0.026110, 0.034714, 0.033098, 0.040062, 0.040447, 0.043741, 0.052871, 0.048723
#*# 	-0.016602, -0.013950, -0.022680, -0.023788, -0.022475, -0.024867, -0.018255, -0.022560, -0.019598, -0.016456, -0.020710, -0.012790, -0.012911, -0.007403, -0.001542, -0.000901, 0.005886, 0.008018, 0.014191, 0.019436, 0.018680, 0.025919, 0.026042, 0.032553, 0.032849, 0.035602, 0.039134, 0.037087, 0.045991, 0.043100
#*# 	-0.010300, -0.013775, -0.019176, -0.020051, -0.022011, -0.019776, -0.020911, -0.019996, -0.016761, -0.020742, -0.014634, -0.015355, -0.011693, -0.003861, -0.004571, 0.004600, 0.006813, 0.009622, 0.017155, 0.016755, 0.022765, 0.021769, 0.024714, 0.031228, 0.029702, 0.032298, 0.032101, 0.033889, 0.040055, 0.038480
#*# 	-0.011078, -0.011367, -0.017201, -0.021012, -0.018091, -0.021107, -0.016498, -0.018748, -0.018806, -0.013952, -0.017549, -0.010657, -0.009726, -0.006021, 0.001349, 0.004943, 0.012717, 0.013879, 0.014523, 0.022099, 0.018184, 0.024116, 0.022113, 0.024086, 0.028903, 0.025366, 0.030046, 0.027471, 0.030282, 0.038138
#*# 	-0.007439, -0.011706, -0.016358, -0.016947, -0.018493, -0.016599, -0.019466, -0.017097, -0.014597, -0.015884, -0.012267, -0.012814, -0.008505, -0.001870, -0.000952, 0.008827, 0.010475, 0.015057, 0.019918, 0.017924, 0.020791, 0.019739, 0.022125, 0.023102, 0.020073, 0.020347, 0.020043, 0.027381, 0.027746, 0.027888
#*# 	-0.006978, -0.009935, -0.011197, -0.016268, -0.013819, -0.016945, -0.015751, -0.014797, -0.015523, -0.012316, -0.013746, -0.009430, -0.006463, -0.003192, 0.004474, 0.006976, 0.012421, 0.016523, 0.014335, 0.020459, 0.015789, 0.020935, 0.020846, 0.013738, 0.021201, 0.015648, 0.020022, 0.019030, 0.016026, 0.025048
#*# 	-0.000282, -0.003702, -0.006867, -0.010795, -0.012862, -0.010642, -0.014868, -0.011657, -0.011555, -0.012671, -0.008472, -0.009771, -0.001788, -0.002514, 0.002083, 0.010421, 0.010028, 0.016086, 0.015050, 0.016929, 0.018937, 0.017324, 0.018929, 0.017125, 0.016812, 0.014570, 0.013363, 0.016903, 0.014579, 0.014727
#*# 	0.002775, -0.001345, -0.002429, -0.008831, -0.007884, -0.007124, -0.010820, -0.007631, -0.010537, -0.004543, -0.004413, -0.006911, -0.000570, 0.001947, 0.008107, 0.010270, 0.009886, 0.016239, 0.014681, 0.021971, 0.015677, 0.015536, 0.020939, 0.011772, 0.018608, 0.011503, 0.009268, 0.014028, 0.004463, 0.014206
#*# 	0.009722, 0.006145, 0.001163, -0.003588, -0.005658, -0.005542, -0.006035, -0.004477, -0.005324, -0.003457, -0.002327, -0.002904, 0.002843, 0.004544, 0.010798, 0.011280, 0.013290, 0.018173, 0.017930, 0.021838, 0.020038, 0.017995, 0.018043, 0.015909, 0.014633, 0.011100, 0.009488, 0.009903, 0.007022, 0.003683
#*# 	0.011698, 0.007671, 0.006445, 0.000763, -0.002818, -0.000315, -0.003028, -0.000207, -0.002421, -0.002225, 0.001510, 0.000910, 0.005688, 0.006512, 0.010554, 0.016163, 0.014658, 0.020359, 0.018417, 0.022040, 0.024278, 0.017852, 0.021148, 0.012692, 0.014460, 0.013025, 0.004812, 0.007792, -0.000690, 0.006716
#*# 	0.017707, 0.014363, 0.008166, 0.005244, 0.003253, 0.002911, 0.001948, 0.001080, 0.001681, 0.001765, 0.002256, 0.004006, 0.005957, 0.007639, 0.014072, 0.015404, 0.018299, 0.020965, 0.020983, 0.022146, 0.021512, 0.020449, 0.018966, 0.017496, 0.013602, 0.009093, 0.006113, 0.005012, 0.003099, -0.001016
#*# 	0.016867, 0.013800, 0.011766, 0.009164, 0.005542, 0.006515, 0.003841, 0.003043, 0.003724, 0.002888, 0.004164, 0.003000, 0.007473, 0.009796, 0.011867, 0.015757, 0.015975, 0.021506, 0.021800, 0.019661, 0.022181, 0.017658, 0.020508, 0.015090, 0.010801, 0.011934, 0.002500, 0.004827, 0.001130, -0.000853
#*# 	0.023024, 0.019201, 0.014192, 0.010818, 0.008675, 0.007500, 0.005619, 0.003754, 0.003603, 0.004010, 0.005101, 0.005272, 0.005901, 0.007093, 0.010844, 0.013847, 0.016971, 0.017777, 0.017972, 0.017933, 0.018539, 0.017979, 0.017022, 0.014404, 0.010702, 0.007869, 0.004248, 0.001741, -0.000234, -0.010521
#*# 	0.023332, 0.021876, 0.017823, 0.017357, 0.011177, 0.009376, 0.007713, 0.005817, 0.007204, 0.005764, 0.006009, 0.007355, 0.007401, 0.010712, 0.009958, 0.014132, 0.012393, 0.013890, 0.016810, 0.015932, 0.018267, 0.014887, 0.012807, 0.016061, 0.008525, 0.008921, -0.000532, -0.005074, -0.002366, -0.009387
#*# 	0.031337, 0.026153, 0.021948, 0.017038, 0.013995, 0.014167, 0.011347, 0.009944, 0.009510, 0.008997, 0.009996, 0.009883, 0.009792, 0.012100, 0.012852, 0.013872, 0.014547, 0.014894, 0.015157, 0.015951, 0.017662, 0.015879, 0.015392, 0.012860, 0.009157, 0.008107, 0.001032, -0.002262, -0.008638, -0.013823
#*# 	0.031975, 0.028953, 0.023800, 0.024456, 0.015904, 0.015020, 0.014191, 0.009699, 0.011333, 0.008843, 0.008658, 0.011332, 0.010472, 0.017191, 0.014902, 0.014646, 0.016204, 0.011050, 0.015941, 0.015173, 0.016695, 0.016785, 0.011588, 0.014266, 0.007866, 0.008043, 0.001191, -0.010820, -0.010129, -0.017345
#*# 	0.036123, 0.031581, 0.026698, 0.021438, 0.017743, 0.017028, 0.013950, 0.011676, 0.010458, 0.010177, 0.010564, 0.011801, 0.011781, 0.014709, 0.016167, 0.016052, 0.015595, 0.013831, 0.012838, 0.013949, 0.012996, 0.012577, 0.012154, 0.008518, 0.006672, -0.000164, -0.005389, -0.009447, -0.017637, -0.021844
#*# 	0.034927, 0.030539, 0.026918, 0.026303, 0.019460, 0.015621, 0.012879, 0.009855, 0.012014, 0.009600, 0.009826, 0.011239, 0.013423, 0.016763, 0.015926, 0.015983, 0.014856, 0.009533, 0.012285, 0.009936, 0.008320, 0.010645, 0.007190, 0.006973, -0.000482, -0.005395, -0.009339, -0.019968, -0.020378, -0.030595
#*# 	0.037948, 0.033609, 0.028603, 0.023081, 0.020551, 0.015732, 0.013851, 0.012195, 0.011813, 0.012315, 0.012440, 0.014061, 0.014310, 0.016664, 0.018428, 0.018020, 0.017653, 0.014272, 0.009859, 0.010875, 0.009962, 0.011772, 0.011804, 0.005180, 0.002603, -0.009271, -0.011087, -0.017825, -0.030102, -0.030965
#*# 	0.039983, 0.034740, 0.033381, 0.027385, 0.024834, 0.018996, 0.016113, 0.015917, 0.014558, 0.014714, 0.014916, 0.017148, 0.017898, 0.020140, 0.022163, 0.021614, 0.020997, 0.012814, 0.012189, 0.013366, 0.011795, 0.014136, 0.008716, 0.004529, 0.001829, -0.009658, -0.014118, -0.027712, -0.031352, -0.035869
#*# 	0.047253, 0.044389, 0.038693, 0.032413, 0.028033, 0.021707, 0.019778, 0.018538, 0.018426, 0.018478, 0.018503, 0.019878, 0.022017, 0.022156, 0.024419, 0.023730, 0.022611, 0.018980, 0.016072, 0.016193, 0.015937, 0.018007, 0.014584, 0.008649, 0.002863, -0.010821, -0.015932, -0.022492, -0.034792, -0.036774
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 12.0
#*# max_x = 207.0
#*# min_y = 23.0
#*# max_y = 195.0
