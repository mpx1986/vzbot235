[respond]

#  Octopus Pro boards STM32H723.  Select the appropriate micro-controller in "make
# menuconfig" and select "Enable low-level configuration options". For
#  For STM32H723 boards use a "128KiB bootloader" and a "25Mhz crystal"
# See docs/Config_Reference.md for a description of parameters.
[exclude_object]
[include mainsail.cfg]
[include config/fan.cfg]
[include config/stepper.cfg]
[include config/led.cfg]
[include config/wiper.cfg]
[include macros/macro.cfg]
[include config/therm2-config.cfg]

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT
[display_status]
[pause_resume]
[respond]   #activate messages
[gcode_arcs]  #activate round corner
resolution: 0.1
[force_move]
enable_force_move: True
[gcode_macro FORCE]
gcode:
      SET_KINEMATIC_POSITION X=105 Y=94 Z=20

#[shaketune]
# result_folder: ~/printer_data/config/ShakeTune_results
# number_of_results_to_keep: 10
# keep_raw_data: False
# show_macros_in_webui: True
# timeout: 60
# measurements_chunk_size: 2
# max_freq: 200
# dpi: 300



[gcode_macro _CLIENT_VARIABLE]
variable_use_custom_pos   : True ; use custom park coordinates for x,y [True/False]
variable_custom_park_x    : 15.0   ; custom x position; value must be within your defined min and max of X
variable_custom_park_y    : 15.0   ; custom y position; value must be within your defined min and max of Y
variable_custom_park_dz   : 25.0   ; custom dz value; the value in mm to lift the nozzle when move to park position
variable_retract          : 0.30   ; the value to retract while PAUSE
variable_cancel_retract   : 0.50   ; the value to retract while CANCEL_PRINT
variable_speed_retract    : 35.0  ; retract speed in mm/s
variable_unretract        : 0.60   ; the value to unretract while RESUME
variable_speed_unretract  : 35.0  ; unretract speed in mm/s
variable_speed_hop        : 15.0  ; z move speed in mm/s
variable_speed_move       : 100.0 ; move speed in mm/s
variable_park_at_cancel   : True ; allow to move the toolhead to park while execute CANCEL_PRINT [True/False]
variable_park_at_cancel_x : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
variable_park_at_cancel_y : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
## !!! Caution [firmware_retraction] must be defined in the printer.cfg if you set use_fw_retract: True !!!
variable_use_fw_retract   : True ; use fw_retraction instead of the manual version [True/False]
variable_idle_timeout     : 0     ; time in sec until idle_timeout kicks in. Value 0 means that no value will be set or restored
#variable_runout_sensor    : "encoder_sensor"    ; If a sensor is defined, it will be used to cancel the execution of RESUME in case no filament is detected.
##                                   Specify the config name of the runout sensor e.g "filament_switch_sensor runout". Hint use the same as in your printer.cfg
## !!! Custom macros, please use with care and review the section of the corresponding macro.
## These macros are for simple operations like setting a status LED. Please make sure your macro does not interfere with the basic macro functions.
## Only  single line commands are supported, please create a macro if you need more than one command.
#variable_user_pause_macro : ""    ; Everything insight the "" will be executed after the klipper base pause (PAUSE_BASE) function
#variable_user_resume_macro: ""    ; Everything insight the "" will be executed before the klipper base resume (RESUME_BASE) function
#variable_user_cancel_macro: ""    ; Everything insight the "" will be executed before the klipper base cancel (CANCEL_PRINT_BASE) function
gcode:

########################
########################
### Printer
########################

[printer]
kinematics: corexy
max_velocity: 1000
max_accel: 60000
minimum_cruise_ratio: 0.7
max_z_velocity: 30
max_z_accel: 2000
square_corner_velocity: 20

#[input_shaper]
#shaper_freq_x: 132.6
#shaper_type_x: ei
#damping_ratio_x: 0.043
#shaper_freq_y: 92.0
#shaper_type_y: ei
#damping_ratio_y: 0.041

[mcu host]
serial: /tmp/klipper_host_mcu

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_32001F000F51313531383332-if00

[mcu scanner]
serial: /dev/serial/by-id/usb-Cartographer_614e_1F000A001653584833373720-if00    

[temperature_sensor Octopus]
sensor_type: temperature_mcu
max_temp: 100

[temperature_sensor raspberry_pi_4B]
sensor_type: temperature_host
min_temp: 10
max_temp: 100 



########################
########################
### Extruder
########################
[extruder]  ##M6
step_pin: PG15
dir_pin: !PB3
enable_pin: !PD5
microsteps: 16
full_steps_per_rotation: 200
rotation_distance: 22.018
Gear_ratio: 50:8
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: PF9
#control: pid
#pid_Kp: 23.216 
#pid_Ki: 1.629 
#pid_Kd: 82.712
min_temp: 0
max_temp: 350

sensor_type: PT1000
sensor_pin: PB0
pullup_resistor: 2200

max_extrude_only_distance: 250.0
max_extrude_cross_section: 250
#pressure_advance: 0.02
pressure_advance_smooth_time: 0.03

[tmc2209 extruder]
uart_pin: PG9
run_current: 0.7
stealthchop_threshold: 0

[firmware_retraction]
retract_length: 0.3
retract_speed: 85
unretract_speed: 85

#[filament_motion_sensor encoder_sensor]
#detection_length: 7
#   The minimum length of filament pulled through the sensor to trigger
#   a state change on the switch_pin
#   Default is 7 mm.
#extruder: extruder
#   The name of the extruder section this sensor is associated with.
#   This parameter must be provided.
#switch_pin: PA9
# changing the switch_pin name according to your motherboard
#pause_on_runout: True
#runout_gcode:
#    M117 Filament switch runout
#insert_gcode: 
#    M117 Filament switch inserted
#event_delay: 
#pause_delay:

########################
########################
### Heatbed
########################

[heater_bed]
heater_pin: PF5
sensor_pin: PB1 # TB
sensor_type: ATC Semitec 104GT-2
min_temp: 0
max_temp: 130
#control: pid
#pid_kp: 54.122
#pid_ki: 2.864
#pid_kd: 255.727
max_power: 0.7

########################
########################
### Cartographer
########################

[scanner]    
mcu: scanner 
x_offset: 0
y_offset: 23    
backlash_comp: 0.00688
sensor: cartographer
sensor_alt: carto   
mesh_runs: 2
samples: 10
samples_tolerance_retries: 8
scanner_touch_sample_count:6
scanner_touch_max_retries:15
scanner_touch_accel: 100
scanner_touch_max_speed: 5 #10

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

[adxl345]
cs_pin: scanner:PA3
spi_bus: spi1

[resonance_tester]
accel_chip: adxl345
probe_points:
    115, 115, 10
########################
########################
### Bed Mesh
########################
[safe_z_home]
home_xy_position: 115,115
speed: 200
z_hop: 5
z_hop_speed: 20.0



[bed_mesh]
speed: 400
horizontal_move_z: 5
mesh_min: 14, 23
mesh_max: 204, 195
mesh_pps: 0,0
move_check_distance: 3
probe_count: 30,30
algorithm: bicubic
zero_reference_position: 115,115

[screws_tilt_adjust]
screw1: 27, 0
screw1_name: vorne links
screw2: 27, 175
screw2_name: hinten links
screw3: 196, 175
screw3_name: hinten rechts
screw4: 196, 0
screw4_name: vorne rechts
speed: 200
horizontal_move_z: 5
screw_thread: CW-M4


[axis_twist_compensation]
speed: 5
horizontal_move_z: 5
calibrate_start_x: 15
calibrate_end_x: 195
calibrate_y: 112.5


#[neopixel my_neopixel_1]
#pin: PE10

#[neopixel my_neopixel_2]
#pin: PE9

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# pid_kp = 45.826
#*# pid_ki = 2.122
#*# pid_kd = 247.461
#*# control = pid
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 22.453
#*# pid_ki = 1.109
#*# pid_kd = 113.667
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 2250
#*# scanner_touch_speed = 2
#*#
#*# [scanner model default]
#*# model_coef = 1.4114227064437468,
#*# 	  1.7583188143049777,
#*# 	  0.6843139716695114,
#*# 	  -0.15697620584128397,
#*# 	  0.8074214900630388,
#*# 	  2.5099176857026224,
#*# 	  -1.015155335853426,
#*# 	  -3.4180215214314913,
#*# 	  0.7585210491352214,
#*# 	  1.7546407940445983
#*# model_domain = 3.140843967840883e-07,3.3106740473797197e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 32.311174
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.672229, -0.601608, -0.560922, -0.511957, -0.468831, -0.442156, -0.431325, -0.425062, -0.379825, -0.347703, -0.312603, -0.310162, -0.295514, -0.269888, -0.202281, -0.175776, -0.164888, -0.156267, -0.128464, -0.088052, -0.036264, -0.008789, -0.015428, 0.012465, 0.054672, 0.097153, 0.123307, 0.134314, 0.144557, 0.116645
#*# 	-0.653259, -0.558828, -0.504470, -0.483959, -0.450083, -0.435352, -0.405101, -0.380578, -0.355255, -0.330779, -0.302469, -0.284550, -0.256805, -0.231396, -0.201227, -0.173108, -0.142089, -0.115439, -0.078299, -0.064457, -0.020614, 0.005653, 0.027864, 0.048692, 0.078684, 0.104680, 0.132311, 0.147510, 0.148540, 0.126199
#*# 	-0.636735, -0.502483, -0.468822, -0.455660, -0.446152, -0.421135, -0.375715, -0.341271, -0.337079, -0.324981, -0.308140, -0.255795, -0.228478, -0.192651, -0.193266, -0.157230, -0.121928, -0.088654, -0.058659, -0.045505, -0.018191, 0.008956, 0.056253, 0.082554, 0.092754, 0.109305, 0.135223, 0.156823, 0.177559, 0.140806
#*# 	-0.614411, -0.507222, -0.455954, -0.436851, -0.409755, -0.395584, -0.369729, -0.342284, -0.320038, -0.294093, -0.268045, -0.246656, -0.219635, -0.185819, -0.168667, -0.144632, -0.117068, -0.084888, -0.055875, -0.023739, -0.007791, 0.025137, 0.052760, 0.075938, 0.102494, 0.122955, 0.148771, 0.170471, 0.175747, 0.162280
#*# 	-0.604169, -0.519617, -0.469189, -0.421810, -0.371410, -0.353054, -0.368358, -0.340434, -0.308976, -0.264082, -0.235751, -0.233954, -0.228891, -0.189715, -0.143847, -0.116460, -0.102699, -0.080469, -0.045880, -0.020892, 0.017554, 0.037358, 0.054738, 0.069009, 0.114910, 0.136166, 0.161770, 0.170731, 0.171119, 0.150553
#*# 	-0.568720, -0.482431, -0.437350, -0.412231, -0.382752, -0.355412, -0.326784, -0.317338, -0.291088, -0.264442, -0.238496, -0.226887, -0.194943, -0.168219, -0.142119, -0.120569, -0.094197, -0.062180, -0.038368, -0.010999, 0.014684, 0.044469, 0.070072, 0.094061, 0.116381, 0.137491, 0.164930, 0.174681, 0.180410, 0.149095
#*# 	-0.557088, -0.433119, -0.390794, -0.392903, -0.383542, -0.357497, -0.296774, -0.286878, -0.279426, -0.267932, -0.246715, -0.207518, -0.171263, -0.152585, -0.137012, -0.122333, -0.083855, -0.034605, -0.010976, -0.004520, 0.015436, 0.048481, 0.081248, 0.105729, 0.123309, 0.143910, 0.161643, 0.178688, 0.189246, 0.153966
#*# 	-0.546992, -0.450759, -0.390452, -0.368397, -0.351335, -0.325529, -0.310858, -0.284470, -0.259908, -0.243651, -0.217769, -0.194995, -0.167373, -0.147630, -0.120649, -0.097821, -0.072120, -0.040628, -0.012974, 0.007612, 0.028438, 0.063421, 0.082123, 0.106123, 0.131532, 0.148649, 0.174961, 0.181962, 0.192858, 0.165571
#*# 	-0.538833, -0.451360, -0.396919, -0.358086, -0.319513, -0.317377, -0.306985, -0.294331, -0.257752, -0.221280, -0.201667, -0.192841, -0.164391, -0.127330, -0.105827, -0.081213, -0.061689, -0.039502, -0.013743, 0.020090, 0.045288, 0.068353, 0.086033, 0.107331, 0.125568, 0.156467, 0.175733, 0.185781, 0.196712, 0.160978
#*# 	-0.521539, -0.426747, -0.372814, -0.350047, -0.323602, -0.299244, -0.277857, -0.262700, -0.239388, -0.216356, -0.201685, -0.176247, -0.150476, -0.130227, -0.110354, -0.080184, -0.053033, -0.029034, 0.001183, 0.025164, 0.043067, 0.068108, 0.087840, 0.115942, 0.131531, 0.149151, 0.172407, 0.191589, 0.195378, 0.155958
#*# 	-0.501075, -0.381447, -0.343075, -0.354002, -0.324430, -0.286547, -0.262230, -0.235576, -0.223677, -0.212460, -0.191684, -0.149083, -0.134864, -0.112149, -0.100518, -0.073201, -0.041504, -0.024521, 0.002481, 0.015777, 0.040898, 0.074113, 0.098384, 0.116549, 0.141500, 0.148594, 0.173633, 0.187665, 0.198586, 0.165569
#*# 	-0.485394, -0.388721, -0.340659, -0.316301, -0.298761, -0.279417, -0.259594, -0.237918, -0.211998, -0.196147, -0.176265, -0.155045, -0.132005, -0.104479, -0.093992, -0.061107, -0.026921, -0.009514, 0.012977, 0.029413, 0.056189, 0.082724, 0.098163, 0.118877, 0.142147, 0.156385, 0.175043, 0.199471, 0.187433, 0.162392
#*# 	-0.466660, -0.394081, -0.354211, -0.287779, -0.278572, -0.265829, -0.250630, -0.237375, -0.204826, -0.174236, -0.147901, -0.152438, -0.128040, -0.098803, -0.078140, -0.052283, -0.032264, -0.013350, 0.012896, 0.047398, 0.070248, 0.089611, 0.101135, 0.119388, 0.137682, 0.161697, 0.175421, 0.186854, 0.192299, 0.158457
#*# 	-0.463547, -0.368231, -0.318660, -0.293569, -0.267903, -0.249529, -0.235869, -0.212722, -0.196297, -0.178012, -0.151099, -0.132465, -0.112702, -0.092853, -0.065460, -0.042555, -0.023440, 0.004892, 0.020965, 0.048493, 0.069758, 0.089504, 0.108859, 0.131324, 0.140851, 0.153531, 0.171403, 0.194250, 0.187672, 0.143423
#*# 	-0.438254, -0.321792, -0.286886, -0.282238, -0.270168, -0.238610, -0.205156, -0.192668, -0.179755, -0.178626, -0.154046, -0.117678, -0.092060, -0.080260, -0.067419, -0.043784, -0.014131, 0.018815, 0.042864, 0.042497, 0.069103, 0.095265, 0.109403, 0.140107, 0.148361, 0.165734, 0.173895, 0.193649, 0.192232, 0.144900
#*# 	-0.421278, -0.336008, -0.287186, -0.262503, -0.245018, -0.225575, -0.207443, -0.182012, -0.175412, -0.155414, -0.135389, -0.108735, -0.090244, -0.072004, -0.050371, -0.024888, -0.001467, 0.024577, 0.039841, 0.063431, 0.075680, 0.100676, 0.122737, 0.124915, 0.148303, 0.160084, 0.181763, 0.193851, 0.192809, 0.156092
#*# 	-0.419739, -0.335718, -0.281497, -0.235804, -0.224977, -0.215684, -0.207824, -0.183823, -0.157138, -0.143174, -0.111901, -0.122035, -0.095120, -0.066109, -0.037831, -0.011144, 0.002271, 0.014857, 0.038853, 0.060334, 0.082935, 0.105774, 0.121049, 0.122491, 0.151489, 0.163490, 0.175726, 0.190863, 0.186558, 0.157240
#*# 	-0.387581, -0.306315, -0.264708, -0.250711, -0.221380, -0.200397, -0.195310, -0.169706, -0.149008, -0.126706, -0.122208, -0.096390, -0.078243, -0.055823, -0.035798, -0.017332, 0.002272, 0.029127, 0.055574, 0.070703, 0.084545, 0.095986, 0.121781, 0.148732, 0.153316, 0.164290, 0.178465, 0.191733, 0.188375, 0.140033
#*# 	-0.386596, -0.281187, -0.235803, -0.236976, -0.213793, -0.199908, -0.166366, -0.149042, -0.145015, -0.130541, -0.108044, -0.086932, -0.061289, -0.041379, -0.024987, -0.015740, 0.020055, 0.036885, 0.055717, 0.067571, 0.091163, 0.106391, 0.126937, 0.135877, 0.148679, 0.166589, 0.176040, 0.183274, 0.186704, 0.150355
#*# 	-0.364098, -0.286062, -0.230873, -0.210159, -0.202600, -0.177992, -0.167622, -0.145138, -0.135866, -0.122215, -0.091522, -0.071917, -0.061396, -0.047231, -0.024001, 0.001987, 0.025775, 0.044226, 0.056265, 0.069238, 0.096747, 0.122646, 0.131526, 0.143953, 0.159897, 0.172124, 0.187220, 0.198153, 0.186583, 0.153914
#*# 	-0.359133, -0.272815, -0.238622, -0.193605, -0.173751, -0.167792, -0.154486, -0.129192, -0.111626, -0.093690, -0.087479, -0.068230, -0.052380, -0.022378, -0.005604, 0.012382, 0.029062, 0.041654, 0.069075, 0.096153, 0.100694, 0.120139, 0.130709, 0.144752, 0.163266, 0.175883, 0.180666, 0.187414, 0.187213, 0.145561
#*# 	-0.333337, -0.255189, -0.209392, -0.178325, -0.161228, -0.153008, -0.136822, -0.123771, -0.111261, -0.088869, -0.071412, -0.066777, -0.041094, -0.024644, -0.004890, 0.013187, 0.029312, 0.055444, 0.073378, 0.096173, 0.104226, 0.114692, 0.122420, 0.149924, 0.167457, 0.175606, 0.174674, 0.196930, 0.182706, 0.138992
#*# 	-0.306330, -0.220489, -0.193005, -0.180925, -0.151841, -0.133162, -0.121408, -0.109865, -0.096137, -0.079610, -0.066937, -0.051596, -0.035388, -0.014392, 0.005681, 0.015622, 0.043123, 0.054514, 0.070213, 0.091145, 0.105910, 0.124461, 0.148668, 0.149813, 0.166627, 0.174622, 0.183456, 0.191765, 0.180911, 0.144591
#*# 	-0.303804, -0.220527, -0.181351, -0.156764, -0.139079, -0.121559, -0.118448, -0.102370, -0.085763, -0.074329, -0.055798, -0.036765, -0.022377, -0.011365, 0.011632, 0.028718, 0.048245, 0.073136, 0.081228, 0.093902, 0.111026, 0.124560, 0.142259, 0.152517, 0.166529, 0.178754, 0.190937, 0.196544, 0.182868, 0.155324
#*# 	-0.297100, -0.215500, -0.164401, -0.138640, -0.134960, -0.117994, -0.107356, -0.084487, -0.071328, -0.054205, -0.043753, -0.029198, -0.012629, 0.002430, 0.018539, 0.036164, 0.056182, 0.065676, 0.087721, 0.107672, 0.122619, 0.136831, 0.146784, 0.161905, 0.174751, 0.183380, 0.189557, 0.199435, 0.188779, 0.144847
#*# 	-0.269141, -0.196563, -0.145237, -0.135886, -0.119850, -0.100050, -0.094222, -0.079614, -0.059778, -0.038624, -0.043221, -0.024526, -0.008754, 0.016612, 0.029777, 0.045157, 0.063008, 0.069475, 0.096940, 0.120990, 0.126518, 0.144171, 0.147015, 0.169882, 0.179052, 0.184337, 0.189539, 0.198900, 0.194453, 0.138580
#*# 	-0.231326, -0.164132, -0.129585, -0.122050, -0.107829, -0.091751, -0.080006, -0.065885, -0.056013, -0.042465, -0.028770, -0.006874, 0.002290, 0.021611, 0.038381, 0.059495, 0.071396, 0.083110, 0.098465, 0.118002, 0.138793, 0.148376, 0.166591, 0.174761, 0.188040, 0.190534, 0.200400, 0.211677, 0.198669, 0.142921
#*# 	-0.226581, -0.147394, -0.123525, -0.107772, -0.092162, -0.080421, -0.065915, -0.056756, -0.049618, -0.038784, -0.010050, -0.001048, 0.019849, 0.029492, 0.038755, 0.065261, 0.080778, 0.097917, 0.096001, 0.121897, 0.135630, 0.154221, 0.174793, 0.174479, 0.183578, 0.192578, 0.200966, 0.204914, 0.199494, 0.153739
#*# 	-0.235141, -0.152352, -0.116461, -0.093002, -0.088809, -0.078237, -0.066244, -0.048976, -0.033992, -0.014432, -0.010023, 0.005711, 0.015715, 0.032342, 0.048656, 0.069976, 0.070230, 0.095198, 0.121449, 0.128129, 0.149193, 0.164917, 0.173690, 0.176149, 0.192368, 0.192169, 0.196408, 0.200492, 0.190015, 0.130365
#*# 	-0.221646, -0.139288, -0.108365, -0.093490, -0.081236, -0.072254, -0.070714, -0.060179, -0.037248, -0.025064, -0.006548, -0.007860, 0.015702, 0.032709, 0.047813, 0.067133, 0.068550, 0.085325, 0.122526, 0.127000, 0.135581, 0.148457, 0.161768, 0.174415, 0.187562, 0.185844, 0.191740, 0.184902, 0.176086, 0.115139
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 14.0
#*# max_x = 204.0
#*# min_y = 23.0
#*# max_y = 195.0
