[respond]

#  Octopus Pro boards STM32H723.  Select the appropriate micro-controller in "make
# menuconfig" and select "Enable low-level configuration options". For
#  For STM32H723 boards use a "128KiB bootloader" and a "25Mhz crystal"
# See docs/Config_Reference.md for a description of parameters.
[exclude_object]
[include mainsail.cfg]
[include config/fan.cfg]
[include config/stepper.cfg]
[include config/led.cfg]
[include config/wiper.cfg]
[include macros/macro.cfg]
[include config/therm2-config.cfg]

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT
[display_status]
[pause_resume]
[respond]   #activate messages
[gcode_arcs]  #activate round corner
resolution: 0.1
[force_move]
enable_force_move: True
[gcode_macro FORCE]
gcode:
      SET_KINEMATIC_POSITION X=105 Y=94 Z=20

#[shaketune]
# result_folder: ~/printer_data/config/ShakeTune_results
# number_of_results_to_keep: 10
# keep_raw_data: False
# show_macros_in_webui: True
# timeout: 60
# measurements_chunk_size: 2
# max_freq: 200
# dpi: 300



[gcode_macro _CLIENT_VARIABLE]
variable_use_custom_pos   : True ; use custom park coordinates for x,y [True/False]
variable_custom_park_x    : 15.0   ; custom x position; value must be within your defined min and max of X
variable_custom_park_y    : 15.0   ; custom y position; value must be within your defined min and max of Y
variable_custom_park_dz   : 25.0   ; custom dz value; the value in mm to lift the nozzle when move to park position
variable_retract          : 0.30   ; the value to retract while PAUSE
variable_cancel_retract   : 0.50   ; the value to retract while CANCEL_PRINT
variable_speed_retract    : 35.0  ; retract speed in mm/s
variable_unretract        : 0.60   ; the value to unretract while RESUME
variable_speed_unretract  : 35.0  ; unretract speed in mm/s
variable_speed_hop        : 15.0  ; z move speed in mm/s
variable_speed_move       : 100.0 ; move speed in mm/s
variable_park_at_cancel   : True ; allow to move the toolhead to park while execute CANCEL_PRINT [True/False]
variable_park_at_cancel_x : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
variable_park_at_cancel_y : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
## !!! Caution [firmware_retraction] must be defined in the printer.cfg if you set use_fw_retract: True !!!
variable_use_fw_retract   : True ; use fw_retraction instead of the manual version [True/False]
variable_idle_timeout     : 0     ; time in sec until idle_timeout kicks in. Value 0 means that no value will be set or restored
#variable_runout_sensor    : "encoder_sensor"    ; If a sensor is defined, it will be used to cancel the execution of RESUME in case no filament is detected.
##                                   Specify the config name of the runout sensor e.g "filament_switch_sensor runout". Hint use the same as in your printer.cfg
## !!! Custom macros, please use with care and review the section of the corresponding macro.
## These macros are for simple operations like setting a status LED. Please make sure your macro does not interfere with the basic macro functions.
## Only  single line commands are supported, please create a macro if you need more than one command.
#variable_user_pause_macro : ""    ; Everything insight the "" will be executed after the klipper base pause (PAUSE_BASE) function
#variable_user_resume_macro: ""    ; Everything insight the "" will be executed before the klipper base resume (RESUME_BASE) function
#variable_user_cancel_macro: ""    ; Everything insight the "" will be executed before the klipper base cancel (CANCEL_PRINT_BASE) function
gcode:

########################
########################
### Printer
########################

[printer]
kinematics: corexy
max_velocity: 1000
max_accel: 60000
minimum_cruise_ratio: 0.7
max_z_velocity: 30
max_z_accel: 2000
square_corner_velocity: 20

#[input_shaper]
#shaper_freq_x: 132.6
#shaper_type_x: ei
#damping_ratio_x: 0.043
#shaper_freq_y: 92.0
#shaper_type_y: ei
#damping_ratio_y: 0.041

[mcu host]
serial: /tmp/klipper_host_mcu

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_32001F000F51313531383332-if00

[mcu scanner]
serial: /dev/serial/by-id/usb-Cartographer_614e_1F000A001653584833373720-if00    

[temperature_sensor Octopus]
sensor_type: temperature_mcu
max_temp: 100

[temperature_sensor raspberry_pi_4B]
sensor_type: temperature_host
min_temp: 10
max_temp: 100 



########################
########################
### Extruder
########################
[extruder]  ##M6
step_pin: PG15
dir_pin: !PB3
enable_pin: !PD5
microsteps: 16
full_steps_per_rotation: 200
rotation_distance: 22.018
Gear_ratio: 50:8
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: PF9
#control: pid
#pid_Kp: 23.216 
#pid_Ki: 1.629 
#pid_Kd: 82.712
min_temp: 0
max_temp: 350

sensor_type: PT1000
sensor_pin: PC4
pullup_resistor: 2200

max_extrude_only_distance: 250.0
max_extrude_cross_section: 250
#pressure_advance: 0.02
pressure_advance_smooth_time: 0.03

[tmc2209 extruder]
uart_pin: PG9
run_current: 0.7
stealthchop_threshold: 0

[firmware_retraction]
retract_length: 0.3
retract_speed: 85
unretract_speed: 85

#[filament_motion_sensor encoder_sensor]
#detection_length: 7
#   The minimum length of filament pulled through the sensor to trigger
#   a state change on the switch_pin
#   Default is 7 mm.
#extruder: extruder
#   The name of the extruder section this sensor is associated with.
#   This parameter must be provided.
#switch_pin: PA9
# changing the switch_pin name according to your motherboard
#pause_on_runout: True
#runout_gcode:
#    M117 Filament switch runout
#insert_gcode: 
#    M117 Filament switch inserted
#event_delay: 
#pause_delay:

########################
########################
### Heatbed
########################

[heater_bed]
heater_pin: PF5
sensor_pin: PB1 # TB
sensor_type: ATC Semitec 104GT-2
min_temp: 0
max_temp: 130
#control: pid
#pid_kp: 54.122
#pid_ki: 2.864
#pid_kd: 255.727
max_power: 0.7

########################
########################
### Cartographer
########################

[scanner]    
mcu: scanner 
x_offset: 0
y_offset: 23    
backlash_comp: 0.00580
sensor: cartographer
sensor_alt: carto   
mesh_runs: 2
samples: 10
samples_tolerance_retries: 8
scanner_touch_sample_count:6
scanner_touch_max_retries:15
scanner_touch_accel: 100
scanner_touch_max_speed: 5 #10

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

[adxl345]
cs_pin: scanner:PA3
spi_bus: spi1

[resonance_tester]
accel_chip: adxl345
probe_points:
    115, 115, 10
########################
########################
### Bed Mesh
########################
[safe_z_home]
home_xy_position: 115,115
speed: 200
z_hop: 5
z_hop_speed: 20.0



[bed_mesh]
speed: 400
horizontal_move_z: 5
mesh_min: 14, 23
mesh_max: 204, 195
mesh_pps: 0,0
move_check_distance: 3
probe_count: 30,30
algorithm: bicubic
zero_reference_position: 115,115

[screws_tilt_adjust]
screw1: 27, 0
screw1_name: vorne links
screw2: 27, 175
screw2_name: hinten links
screw3: 196, 175
screw3_name: hinten rechts
screw4: 196, 0
screw4_name: vorne rechts
speed: 200
horizontal_move_z: 5
screw_thread: CW-M4


[axis_twist_compensation]
speed: 5
horizontal_move_z: 5
calibrate_start_x: 15
calibrate_end_x: 195
calibrate_y: 112.5


#[neopixel my_neopixel_1]
#pin: PE10

#[neopixel my_neopixel_2]
#pin: PE9

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# pid_kp = 45.826
#*# pid_ki = 2.122
#*# pid_kd = 247.461
#*# control = pid
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 22.453
#*# pid_ki = 1.109
#*# pid_kd = 113.667
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 2500
#*# scanner_touch_speed = 2
#*# scanner_touch_z_offset = 0.185
#*#
#*# [scanner model default]
#*# model_coef = 1.4619123123181441,
#*# 	1.800908421676754,
#*# 	0.7579660028282674,
#*# 	0.24470582735908372,
#*# 	0.4292607869495228,
#*# 	0.8248193026960383,
#*# 	-0.31666656375168306,
#*# 	-0.9596619710147767,
#*# 	0.3178360917346172,
#*# 	0.5405989637108669
#*# model_domain = 3.1836452592756635e-07,3.3151904823760543e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 29.243690
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.224699, -0.226732, -0.225680, -0.221456, -0.206127, -0.200739, -0.198304, -0.194795, -0.186472, -0.169974, -0.160187, -0.153598, -0.145751, -0.133819, -0.117301, -0.101486, -0.090706, -0.079282, -0.066667, -0.049643, -0.033787, -0.021370, -0.009789, 0.001961, 0.019542, 0.035285, 0.044762, 0.052363, 0.065018, 0.076274
#*# 	-0.214334, -0.213056, -0.209637, -0.207507, -0.200413, -0.193737, -0.188709, -0.183119, -0.175523, -0.165518, -0.155562, -0.145415, -0.134289, -0.123409, -0.111700, -0.098050, -0.085366, -0.071595, -0.058394, -0.045349, -0.031904, -0.018376, -0.002678, 0.009908, 0.022962, 0.036125, 0.047614, 0.056283, 0.070543, 0.082544
#*# 	-0.200534, -0.193555, -0.189015, -0.192837, -0.195134, -0.191078, -0.181212, -0.170579, -0.167101, -0.162374, -0.153869, -0.138922, -0.123698, -0.113240, -0.105754, -0.096985, -0.079578, -0.063076, -0.048371, -0.040615, -0.029569, -0.016230, -0.000551, 0.015266, 0.027048, 0.037953, 0.048962, 0.062766, 0.080822, 0.087786
#*# 	-0.194657, -0.188669, -0.185124, -0.181266, -0.181706, -0.177350, -0.172550, -0.167183, -0.159708, -0.151700, -0.142789, -0.132773, -0.122266, -0.112958, -0.101224, -0.087447, -0.074589, -0.063702, -0.050297, -0.037293, -0.022674, -0.009504, 0.002534, 0.013896, 0.027673, 0.040866, 0.051898, 0.064469, 0.076813, 0.088863
#*# 	-0.180155, -0.180973, -0.180078, -0.172624, -0.164912, -0.161819, -0.162147, -0.160364, -0.149477, -0.139719, -0.129348, -0.125346, -0.119339, -0.108918, -0.089184, -0.078745, -0.069869, -0.060096, -0.046366, -0.030661, -0.017336, -0.004869, 0.003571, 0.014972, 0.030484, 0.045120, 0.055568, 0.065314, 0.075174, 0.086814
#*# 	-0.165620, -0.163313, -0.161396, -0.158774, -0.154234, -0.150423, -0.148278, -0.143587, -0.137800, -0.130684, -0.123027, -0.115052, -0.104499, -0.095005, -0.084710, -0.074719, -0.061637, -0.047965, -0.034889, -0.022487, -0.011710, -0.000377, 0.011913, 0.023808, 0.034345, 0.044929, 0.055826, 0.067546, 0.079077, 0.089006
#*# 	-0.151456, -0.144097, -0.141635, -0.142648, -0.144955, -0.142819, -0.130237, -0.126772, -0.123865, -0.121189, -0.114351, -0.101877, -0.089574, -0.082206, -0.076801, -0.065039, -0.050182, -0.034639, -0.022508, -0.013838, -0.003393, 0.007383, 0.021065, 0.032199, 0.041548, 0.050332, 0.061056, 0.071872, 0.082205, 0.091115
#*# 	-0.141574, -0.137031, -0.132577, -0.129464, -0.129048, -0.126789, -0.123085, -0.119391, -0.113723, -0.106172, -0.098196, -0.091149, -0.084550, -0.076458, -0.064654, -0.051692, -0.040296, -0.031092, -0.021033, -0.009464, 0.005201, 0.017071, 0.025528, 0.033465, 0.042053, 0.053279, 0.064857, 0.073517, 0.079713, 0.089424
#*# 	-0.126115, -0.126736, -0.127711, -0.120195, -0.113065, -0.110895, -0.114933, -0.110533, -0.101985, -0.093102, -0.086396, -0.082284, -0.077454, -0.069028, -0.054272, -0.044180, -0.035787, -0.025549, -0.013744, -0.001038, 0.010475, 0.020337, 0.028651, 0.036988, 0.048115, 0.056716, 0.065068, 0.072781, 0.081252, 0.091084
#*# 	-0.121168, -0.115875, -0.114791, -0.113134, -0.109379, -0.105487, -0.102047, -0.098392, -0.092917, -0.089267, -0.083319, -0.077855, -0.067256, -0.059005, -0.052941, -0.046166, -0.034684, -0.021044, -0.007345, 0.002931, 0.009200, 0.018230, 0.030277, 0.040704, 0.048858, 0.054565, 0.061453, 0.069093, 0.080896, 0.089296
#*# 	-0.109025, -0.101927, -0.099397, -0.103441, -0.105257, -0.103684, -0.090580, -0.088240, -0.087137, -0.084972, -0.080669, -0.070888, -0.061247, -0.055352, -0.050457, -0.041192, -0.028983, -0.015535, -0.005337, 0.004592, 0.013269, 0.022496, 0.030335, 0.037825, 0.046150, 0.053437, 0.060678, 0.068039, 0.076556, 0.084519
#*# 	-0.101559, -0.096157, -0.092365, -0.092033, -0.092780, -0.091587, -0.087894, -0.084597, -0.079887, -0.075725, -0.069549, -0.063864, -0.057512, -0.052667, -0.043470, -0.032289, -0.023016, -0.014150, -0.006286, 0.004091, 0.014508, 0.025067, 0.030954, 0.034929, 0.042542, 0.051186, 0.060044, 0.067307, 0.070535, 0.078153
#*# 	-0.087423, -0.087544, -0.089158, -0.083599, -0.079536, -0.077119, -0.082850, -0.079233, -0.071936, -0.063209, -0.058304, -0.055880, -0.051396, -0.044022, -0.034182, -0.026236, -0.018941, -0.010669, 0.000153, 0.009732, 0.017906, 0.024603, 0.030431, 0.037139, 0.043510, 0.050466, 0.056889, 0.063531, 0.069883, 0.077007
#*# 	-0.073090, -0.073666, -0.076736, -0.075556, -0.071862, -0.069443, -0.069312, -0.066419, -0.061386, -0.057082, -0.051201, -0.046786, -0.040573, -0.034224, -0.027982, -0.022638, -0.012190, -0.001794, 0.008100, 0.015829, 0.021820, 0.027690, 0.034188, 0.040150, 0.044546, 0.049797, 0.054476, 0.060861, 0.068054, 0.074461
#*# 	-0.063817, -0.056370, -0.056738, -0.062216, -0.067625, -0.061278, -0.054650, -0.053046, -0.053095, -0.051285, -0.046194, -0.037795, -0.029878, -0.027626, -0.022105, -0.015498, -0.004106, 0.006680, 0.015270, 0.020269, 0.026870, 0.032736, 0.038118, 0.041773, 0.046795, 0.050495, 0.055795, 0.062123, 0.067114, 0.072580
#*# 	-0.057554, -0.052154, -0.048425, -0.048912, -0.052144, -0.053381, -0.051858, -0.047928, -0.045365, -0.040584, -0.036065, -0.031184, -0.026854, -0.023319, -0.014710, -0.005206, 0.002893, 0.008878, 0.015611, 0.022196, 0.030315, 0.038311, 0.040755, 0.043189, 0.047246, 0.050321, 0.055835, 0.060511, 0.064310, 0.069666
#*# 	-0.043880, -0.044546, -0.048789, -0.044711, -0.041160, -0.044266, -0.047429, -0.046832, -0.038822, -0.032273, -0.028975, -0.026271, -0.022933, -0.015875, -0.007803, -0.001267, 0.004029, 0.011646, 0.019035, 0.025621, 0.032743, 0.037221, 0.040342, 0.043496, 0.047505, 0.050273, 0.053351, 0.057169, 0.059835, 0.065533
#*# 	-0.033393, -0.035473, -0.038152, -0.038803, -0.037507, -0.036548, -0.036419, -0.034740, -0.031147, -0.029598, -0.027788, -0.022621, -0.016111, -0.008973, -0.003639, -0.000624, 0.003941, 0.013401, 0.023241, 0.029842, 0.032654, 0.034849, 0.040275, 0.044466, 0.046543, 0.046730, 0.048497, 0.050931, 0.055014, 0.058981
#*# 	-0.027514, -0.022389, -0.022751, -0.027655, -0.033274, -0.028912, -0.024697, -0.024049, -0.025266, -0.025644, -0.019343, -0.013640, -0.007998, -0.005210, -0.002643, 0.002343, 0.010914, 0.018986, 0.024584, 0.029923, 0.034436, 0.039270, 0.042093, 0.043841, 0.046800, 0.048981, 0.049790, 0.051446, 0.053474, 0.057102
#*# 	-0.016571, -0.016106, -0.011056, -0.014272, -0.016263, -0.016838, -0.017379, -0.016400, -0.013958, -0.013045, -0.009089, -0.005824, -0.002204, -0.000325, 0.003894, 0.010811, 0.018569, 0.023500, 0.028302, 0.033186, 0.038727, 0.043968, 0.047000, 0.047793, 0.048530, 0.049352, 0.050864, 0.052871, 0.053705, 0.056023
#*# 	-0.001962, -0.005346, -0.002019, 0.000605, -0.000044, -0.004923, -0.009891, -0.010100, -0.004102, 0.000538, -0.000531, -0.000761, 0.002895, 0.008518, 0.015186, 0.019132, 0.023017, 0.026130, 0.033490, 0.039427, 0.043912, 0.048376, 0.049698, 0.050322, 0.051121, 0.051487, 0.052753, 0.053752, 0.055115, 0.056085
#*# 	0.006484, 0.009152, 0.011200, 0.008295, 0.008492, 0.008456, 0.005957, 0.005230, 0.006459, 0.007181, 0.007871, 0.010842, 0.014258, 0.017416, 0.021580, 0.024499, 0.027346, 0.033803, 0.039372, 0.044166, 0.046724, 0.050501, 0.051689, 0.052826, 0.052253, 0.053185, 0.053064, 0.053381, 0.054138, 0.055123
#*# 	0.018838, 0.026447, 0.022827, 0.018075, 0.016202, 0.018910, 0.019891, 0.018559, 0.015338, 0.012270, 0.016716, 0.021473, 0.023860, 0.023581, 0.024276, 0.028215, 0.033840, 0.039824, 0.041475, 0.044605, 0.048441, 0.052999, 0.054480, 0.054062, 0.053682, 0.054068, 0.052501, 0.052053, 0.052773, 0.053037
#*# 	0.029508, 0.031069, 0.033317, 0.034048, 0.029852, 0.025974, 0.024482, 0.024135, 0.023386, 0.022118, 0.022182, 0.025975, 0.028151, 0.027774, 0.030825, 0.035655, 0.039785, 0.041578, 0.045002, 0.048234, 0.052274, 0.053840, 0.055234, 0.054389, 0.053323, 0.051796, 0.050839, 0.049787, 0.049275, 0.049784
#*# 	0.042585, 0.041654, 0.046070, 0.047488, 0.045295, 0.037803, 0.031827, 0.027547, 0.031835, 0.035015, 0.031228, 0.028940, 0.030374, 0.036399, 0.043074, 0.042538, 0.042154, 0.045894, 0.052060, 0.055779, 0.056700, 0.056849, 0.056284, 0.055392, 0.055090, 0.053686, 0.051847, 0.050536, 0.048939, 0.048182
#*# 	0.058111, 0.061047, 0.059757, 0.056335, 0.053254, 0.050160, 0.045589, 0.043065, 0.040500, 0.039405, 0.039217, 0.040456, 0.043603, 0.045780, 0.047308, 0.048473, 0.049852, 0.051731, 0.055007, 0.056997, 0.058154, 0.060456, 0.060542, 0.059084, 0.057017, 0.055216, 0.053408, 0.051873, 0.049666, 0.047045
#*# 	0.071840, 0.078864, 0.073504, 0.067016, 0.062726, 0.061140, 0.060055, 0.052084, 0.045404, 0.045116, 0.049383, 0.054899, 0.057178, 0.054624, 0.052602, 0.058074, 0.062037, 0.062897, 0.061316, 0.061138, 0.063328, 0.067906, 0.068557, 0.065976, 0.063869, 0.060401, 0.057173, 0.055199, 0.052340, 0.049670
#*# 	0.088030, 0.087108, 0.086866, 0.082077, 0.075403, 0.069682, 0.065587, 0.060507, 0.058056, 0.056651, 0.056207, 0.059787, 0.060303, 0.060498, 0.061632, 0.065042, 0.064941, 0.065949, 0.066122, 0.066930, 0.069983, 0.072398, 0.074158, 0.072594, 0.068089, 0.063858, 0.058303, 0.055676, 0.053484, 0.048812
#*# 	0.096341, 0.095963, 0.094214, 0.090535, 0.087231, 0.079895, 0.072192, 0.069285, 0.070020, 0.068367, 0.064618, 0.063986, 0.064429, 0.067754, 0.071122, 0.068748, 0.064430, 0.068720, 0.072282, 0.075573, 0.077409, 0.079101, 0.079984, 0.078448, 0.072279, 0.065427, 0.057455, 0.052293, 0.049357, 0.044469
#*# 	0.110856, 0.105486, 0.101350, 0.093914, 0.091943, 0.086702, 0.079554, 0.075523, 0.074051, 0.072070, 0.069113, 0.067280, 0.072431, 0.070085, 0.068844, 0.067403, 0.063798, 0.069632, 0.073444, 0.076100, 0.076546, 0.079199, 0.080245, 0.078831, 0.070702, 0.063255, 0.051905, 0.044158, 0.038734, 0.032936
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 14.0
#*# max_x = 204.0
#*# min_y = 23.0
#*# max_y = 195.0
