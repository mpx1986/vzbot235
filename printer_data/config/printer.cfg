[respond]

#  Octopus Pro boards STM32H723.  Select the appropriate micro-controller in "make
# menuconfig" and select "Enable low-level configuration options". For
#  For STM32H723 boards use a "128KiB bootloader" and a "25Mhz crystal"
# See docs/Config_Reference.md for a description of parameters.
[exclude_object]
[include mainsail.cfg]
[include config/fan.cfg]
[include config/stepper.cfg]
[include config/led.cfg]
[include config/wiper.cfg]
[include macros/macro.cfg]
[include config/therm2-config.cfg]

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT
[display_status]
[pause_resume]
[respond]   #activate messages
[gcode_arcs]  #activate round corner
resolution: 0.1
[force_move]
enable_force_move: True
[gcode_macro FORCE]
gcode:
      SET_KINEMATIC_POSITION X=105 Y=94 Z=20

[shaketune]
result_folder: ~/printer_data/config/ShakeTune_results
number_of_results_to_keep: 10
keep_raw_data: False
show_macros_in_webui: True
timeout: 60
measurements_chunk_size: 2
max_freq: 200
dpi: 300



[gcode_macro _CLIENT_VARIABLE]
variable_use_custom_pos   : True ; use custom park coordinates for x,y [True/False]
variable_custom_park_x    : 15.0   ; custom x position; value must be within your defined min and max of X
variable_custom_park_y    : 15.0   ; custom y position; value must be within your defined min and max of Y
variable_custom_park_dz   : 25.0   ; custom dz value; the value in mm to lift the nozzle when move to park position
variable_retract          : 0.30   ; the value to retract while PAUSE
variable_cancel_retract   : 0.50   ; the value to retract while CANCEL_PRINT
variable_speed_retract    : 35.0  ; retract speed in mm/s
variable_unretract        : 0.60   ; the value to unretract while RESUME
variable_speed_unretract  : 35.0  ; unretract speed in mm/s
variable_speed_hop        : 15.0  ; z move speed in mm/s
variable_speed_move       : 100.0 ; move speed in mm/s
variable_park_at_cancel   : True ; allow to move the toolhead to park while execute CANCEL_PRINT [True/False]
variable_park_at_cancel_x : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
variable_park_at_cancel_y : 15  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
## !!! Caution [firmware_retraction] must be defined in the printer.cfg if you set use_fw_retract: True !!!
variable_use_fw_retract   : True ; use fw_retraction instead of the manual version [True/False]
variable_idle_timeout     : 0     ; time in sec until idle_timeout kicks in. Value 0 means that no value will be set or restored
#variable_runout_sensor    : "encoder_sensor"    ; If a sensor is defined, it will be used to cancel the execution of RESUME in case no filament is detected.
##                                   Specify the config name of the runout sensor e.g "filament_switch_sensor runout". Hint use the same as in your printer.cfg
## !!! Custom macros, please use with care and review the section of the corresponding macro.
## These macros are for simple operations like setting a status LED. Please make sure your macro does not interfere with the basic macro functions.
## Only  single line commands are supported, please create a macro if you need more than one command.
#variable_user_pause_macro : ""    ; Everything insight the "" will be executed after the klipper base pause (PAUSE_BASE) function
#variable_user_resume_macro: ""    ; Everything insight the "" will be executed before the klipper base resume (RESUME_BASE) function
#variable_user_cancel_macro: ""    ; Everything insight the "" will be executed before the klipper base cancel (CANCEL_PRINT_BASE) function
gcode:

########################
########################
### Printer
########################

[printer]
kinematics: corexy
max_velocity: 1000
max_accel: 60000
minimum_cruise_ratio: 0.7
max_z_velocity: 30
max_z_accel: 2000
square_corner_velocity: 20

#[input_shaper]
#shaper_freq_x: 132.6
#shaper_type_x: ei
#damping_ratio_x: 0.043
#shaper_freq_y: 92.0
#shaper_type_y: ei
#damping_ratio_y: 0.041

[mcu host]
serial: /tmp/klipper_host_mcu

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_32001F000F51313531383332-if00

[mcu scanner]
serial: /dev/serial/by-id/usb-Cartographer_614e_1F000A001653584833373720-if00    

[temperature_sensor Octopus]
sensor_type: temperature_mcu
max_temp: 100

[temperature_sensor raspberry_pi_4B]
sensor_type: temperature_host
min_temp: 10
max_temp: 100 



########################
########################
### Extruder
########################
[extruder]  ##M6
step_pin: PG15
dir_pin: !PB3
enable_pin: !PD5
microsteps: 16
full_steps_per_rotation: 200
rotation_distance: 22.018
Gear_ratio: 50:8
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: PA0
#control: pid
#pid_Kp: 23.216 
#pid_Ki: 1.629 
#pid_Kd: 82.712
min_temp: 0
max_temp: 350

sensor_type: PT1000
sensor_pin: PB0
pullup_resistor: 2200

max_extrude_only_distance: 250.0
max_extrude_cross_section: 250
#pressure_advance: 0.02
pressure_advance_smooth_time: 0.03

[tmc2209 extruder]
uart_pin: PG9
run_current: 0.7
stealthchop_threshold: 0

[firmware_retraction]
retract_length: 0.3
retract_speed: 85
unretract_speed: 85

#[filament_motion_sensor encoder_sensor]
#detection_length: 7
#   The minimum length of filament pulled through the sensor to trigger
#   a state change on the switch_pin
#   Default is 7 mm.
#extruder: extruder
#   The name of the extruder section this sensor is associated with.
#   This parameter must be provided.
#switch_pin: PA9
# changing the switch_pin name according to your motherboard
#pause_on_runout: True
#runout_gcode:
#    M117 Filament switch runout
#insert_gcode: 
#    M117 Filament switch inserted
#event_delay: 
#pause_delay:

########################
########################
### Heatbed
########################

[heater_bed]
heater_pin: PF5
sensor_pin: PB1 # TB
sensor_type: ATC Semitec 104GT-2
min_temp: 0
max_temp: 130
#control: pid
#pid_kp: 54.122
#pid_ki: 2.864
#pid_kd: 255.727
max_power: 0.7

########################
########################
### Cartographer
########################

[scanner]    
mcu: scanner 
x_offset: 0
y_offset: 23    
backlash_comp: 0.00688
sensor: cartographer
sensor_alt: carto   
mesh_runs: 2
samples: 10
samples_tolerance_retries: 8
scanner_touch_sample_count:6
scanner_touch_max_retries:15
scanner_touch_accel: 100
scanner_touch_max_speed: 5 #10

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

[adxl345]
cs_pin: scanner:PA3
spi_bus: spi1

[resonance_tester]
accel_chip: adxl345
probe_points:
    115, 115, 10
########################
########################
### Bed Mesh
########################
[safe_z_home]
home_xy_position: 115,115
speed: 200
z_hop: 5
z_hop_speed: 20.0



[bed_mesh]
speed: 400
horizontal_move_z: 5
mesh_min: 14, 23
mesh_max: 204, 195
mesh_pps: 0,0
move_check_distance: 3
probe_count: 30,30
algorithm: bicubic
zero_reference_position: 115,115

[screws_tilt_adjust]
screw1: 27, 0
screw1_name: vorne links
screw2: 27, 175
screw2_name: hinten links
screw3: 196, 175
screw3_name: hinten rechts
screw4: 196, 0
screw4_name: vorne rechts
speed: 200
horizontal_move_z: 5
screw_thread: CW-M4


[axis_twist_compensation]
speed: 5
horizontal_move_z: 5
calibrate_start_x: 15
calibrate_end_x: 195
calibrate_y: 112.5


#[neopixel my_neopixel_1]
#pin: PE10

#[neopixel my_neopixel_2]
#pin: PE9

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# pid_kp = 45.826
#*# pid_ki = 2.122
#*# pid_kd = 247.461
#*# control = pid
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 42.422
#*# pid_ki = 10.877
#*# pid_kd = 41.362
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 2500
#*# scanner_touch_speed = 2
#*# scanner_touch_z_offset = 0.085
#*#
#*# [scanner model default]
#*# model_coef = 1.4300517024977009,
#*# 	1.7489357800207448,
#*# 	0.7382830121972929,
#*# 	0.32598013659741637,
#*# 	0.5187289973621346,
#*# 	0.6444789707587599,
#*# 	-0.43921102305230186,
#*# 	-0.7407254362354236,
#*# 	0.40273205446912425,
#*# 	0.47276731514430037
#*# model_domain = 3.153945360763991e-07,3.312084772355736e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 28.045693
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -0.479867, -0.470843, -0.454458, -0.432287, -0.401618, -0.381918, -0.371877, -0.352540, -0.323117, -0.292872, -0.269716, -0.252312, -0.233875, -0.206980, -0.169195, -0.141143, -0.120339, -0.099138, -0.072111, -0.039957, -0.007288, 0.018485, 0.038460, 0.063254, 0.095407, 0.126335, 0.149878, 0.170452, 0.192972, 0.216385
#*# 	  -0.464231, -0.450882, -0.431553, -0.416886, -0.394682, -0.375759, -0.355284, -0.334914, -0.312835, -0.290063, -0.265899, -0.243026, -0.217566, -0.192140, -0.165635, -0.139291, -0.112716, -0.085664, -0.059426, -0.032982, -0.005091, 0.021640, 0.049501, 0.075913, 0.102122, 0.128467, 0.152003, 0.172683, 0.202043, 0.222614
#*# 	  -0.449913, -0.428004, -0.409077, -0.400926, -0.389313, -0.372474, -0.339878, -0.320008, -0.303809, -0.286550, -0.263795, -0.233748, -0.203157, -0.179499, -0.163749, -0.138029, -0.105409, -0.074019, -0.047245, -0.025640, -0.003089, 0.023973, 0.060734, 0.084444, 0.107293, 0.129908, 0.154015, 0.186556, 0.214923, 0.234679
#*# 	  -0.439585, -0.422837, -0.406195, -0.389923, -0.371217, -0.353698, -0.335393, -0.317447, -0.295911, -0.273581, -0.248510, -0.225585, -0.201712, -0.177528, -0.152418, -0.125092, -0.099111, -0.074015, -0.047237, -0.021973, 0.006691, 0.033519, 0.059661, 0.084001, 0.109930, 0.135953, 0.161445, 0.186366, 0.209310, 0.232302
#*# 	  -0.425832, -0.415904, -0.401091, -0.376829, -0.353414, -0.335806, -0.327450, -0.308939, -0.282209, -0.256097, -0.233560, -0.217029, -0.198084, -0.174609, -0.138688, -0.112921, -0.091117, -0.070443, -0.043363, -0.007541, 0.017494, 0.042413, 0.060747, 0.085125, 0.115491, 0.143780, 0.166293, 0.184977, 0.208133, 0.234975
#*# 	  -0.409002, -0.393272, -0.376658, -0.360209, -0.343390, -0.325200, -0.308671, -0.288814, -0.268296, -0.248615, -0.228247, -0.205517, -0.179076, -0.155862, -0.131561, -0.108153, -0.083170, -0.055310, -0.027348, -0.003134, 0.020002, 0.045021, 0.072514, 0.097615, 0.121375, 0.145406, 0.167995, 0.191263, 0.217599, 0.242587
#*# 	  -0.392221, -0.370004, -0.353438, -0.342701, -0.330325, -0.315493, -0.285850, -0.267652, -0.252021, -0.237202, -0.215627, -0.184860, -0.162858, -0.139869, -0.122893, -0.098821, -0.068644, -0.039721, -0.014209, 0.005293, 0.029567, 0.058189, 0.084784, 0.107701, 0.129554, 0.150482, 0.173825, 0.200996, 0.222048, 0.241098
#*# 	  -0.379965, -0.362750, -0.345621, -0.329137, -0.312338, -0.295473, -0.278784, -0.261126, -0.240267, -0.219121, -0.195970, -0.175089, -0.155449, -0.135707, -0.111875, -0.081467, -0.056790, -0.035609, -0.012147, 0.011935, 0.043309, 0.067845, 0.090725, 0.109671, 0.132378, 0.156800, 0.180356, 0.202552, 0.221228, 0.241228
#*# 	  -0.366838, -0.357900, -0.340339, -0.308478, -0.292960, -0.277379, -0.270496, -0.251932, -0.226680, -0.201975, -0.182747, -0.168492, -0.148044, -0.122349, -0.094714, -0.071513, -0.050701, -0.029385, -0.004011, 0.025745, 0.049819, 0.072354, 0.093649, 0.115332, 0.139068, 0.161112, 0.181809, 0.203153, 0.224193, 0.245963
#*# 	  -0.354623, -0.338806, -0.320683, -0.304763, -0.288739, -0.271996, -0.254192, -0.235137, -0.216063, -0.197806, -0.180483, -0.160046, -0.136436, -0.111702, -0.089125, -0.072717, -0.050790, -0.021208, 0.006983, 0.030490, 0.049821, 0.069644, 0.092211, 0.120551, 0.141415, 0.160550, 0.178683, 0.199701, 0.229016, 0.249882
#*# 	  -0.342459, -0.317880, -0.302199, -0.302555, -0.286504, -0.262833, -0.239624, -0.222644, -0.208570, -0.194581, -0.175067, -0.146435, -0.126892, -0.109960, -0.090189, -0.067470, -0.041509, -0.015774, 0.007967, 0.031357, 0.053432, 0.076704, 0.098469, 0.118255, 0.140477, 0.160701, 0.180357, 0.202160, 0.223588, 0.245052
#*# 	  -0.329723, -0.314920, -0.298921, -0.283691, -0.268760, -0.251407, -0.234373, -0.220403, -0.203092, -0.181990, -0.157338, -0.137771, -0.121840, -0.107918, -0.087264, -0.051838, -0.028388, -0.012006, 0.006878, 0.029552, 0.057357, 0.085572, 0.105486, 0.114008, 0.133897, 0.159929, 0.184461, 0.205472, 0.220381, 0.236665
#*# 	  -0.314903, -0.308241, -0.292318, -0.265345, -0.252663, -0.240879, -0.226697, -0.209854, -0.188241, -0.168888, -0.150224, -0.130904, -0.111395, -0.092852, -0.071738, -0.051110, -0.027701, -0.004363, 0.018204, 0.042835, 0.062873, 0.083117, 0.102628, 0.120943, 0.140006, 0.160764, 0.179624, 0.201668, 0.220109, 0.241636
#*# 	  -0.300003, -0.287525, -0.271470, -0.258204, -0.243990, -0.230391, -0.216128, -0.192778, -0.174163, -0.158919, -0.144990, -0.126201, -0.101425, -0.075470, -0.054810, -0.046071, -0.025084, 0.004759, 0.034674, 0.054912, 0.068552, 0.081743, 0.099919, 0.131593, 0.148833, 0.161612, 0.175171, 0.194552, 0.220624, 0.247428
#*# 	  -0.283819, -0.264751, -0.251239, -0.250585, -0.235892, -0.215981, -0.197083, -0.181405, -0.165403, -0.147411, -0.128220, -0.108799, -0.090448, -0.071330, -0.050179, -0.029853, -0.006988, 0.015856, 0.037440, 0.058776, 0.078572, 0.096553, 0.114133, 0.130847, 0.149219, 0.166952, 0.184292, 0.202892, 0.222263, 0.241673
#*# 	  -0.273246, -0.260987, -0.246611, -0.232543, -0.218273, -0.201862, -0.186756, -0.175017, -0.159129, -0.142486, -0.113983, -0.095129, -0.081009, -0.068012, -0.048042, -0.013952, 0.008030, 0.023162, 0.037544, 0.056980, 0.083120, 0.108307, 0.125155, 0.129604, 0.145859, 0.168511, 0.190619, 0.208342, 0.222028, 0.234216
#*# 	  -0.261642, -0.258972, -0.243874, -0.215528, -0.203111, -0.193781, -0.183214, -0.166567, -0.146452, -0.127056, -0.109577, -0.092037, -0.073341, -0.054042, -0.033422, -0.014285, 0.008418, 0.028815, 0.048984, 0.069206, 0.087579, 0.104978, 0.122185, 0.137268, 0.154754, 0.170075, 0.186093, 0.203878, 0.219698, 0.237370
#*# 	  -0.252097, -0.239136, -0.225205, -0.212809, -0.199309, -0.187015, -0.173484, -0.155064, -0.134695, -0.118733, -0.108849, -0.090771, -0.066241, -0.041085, -0.021829, -0.008946, 0.005309, 0.025183, 0.059138, 0.078364, 0.088955, 0.100316, 0.116482, 0.144149, 0.158829, 0.169175, 0.179450, 0.195701, 0.216456, 0.239527
#*# 	  -0.242006, -0.222367, -0.208794, -0.209175, -0.195554, -0.175316, -0.156398, -0.142596, -0.132462, -0.116115, -0.095525, -0.074797, -0.057556, -0.040404, -0.022106, -0.002616, 0.018751, 0.037589, 0.057117, 0.076327, 0.093171, 0.110578, 0.125993, 0.140021, 0.157235, 0.171621, 0.186244, 0.201134, 0.216787, 0.232004
#*# 	  -0.230133, -0.217508, -0.202454, -0.189021, -0.176150, -0.161915, -0.147667, -0.134475, -0.121956, -0.107072, -0.080756, -0.063361, -0.050302, -0.037069, -0.019307, 0.004783, 0.029601, 0.048962, 0.057381, 0.074909, 0.097959, 0.120521, 0.135402, 0.144595, 0.155044, 0.169758, 0.192117, 0.207121, 0.217563, 0.228957
#*# 	  -0.226316, -0.215394, -0.190205, -0.170604, -0.158466, -0.150519, -0.141247, -0.127856, -0.103812, -0.088938, -0.075837, -0.060564, -0.043119, -0.024168, -0.004756, 0.012709, 0.030169, 0.047410, 0.066922, 0.084963, 0.102649, 0.120099, 0.134331, 0.148539, 0.163660, 0.175902, 0.189528, 0.204820, 0.218171, 0.233880
#*# 	  -0.206541, -0.192153, -0.176313, -0.162577, -0.150251, -0.138761, -0.125985, -0.111161, -0.093687, -0.079510, -0.069060, -0.052292, -0.031972, -0.011242, 0.006648, 0.019467, 0.032604, 0.050116, 0.077990, 0.095713, 0.107860, 0.120790, 0.134953, 0.152114, 0.167408, 0.181433, 0.188221, 0.202572, 0.219417, 0.234861
#*# 	  -0.184728, -0.172656, -0.165679, -0.159745, -0.146852, -0.125860, -0.108659, -0.096874, -0.090724, -0.075906, -0.057402, -0.037703, -0.022193, -0.008825, 0.005411, 0.022038, 0.045496, 0.061373, 0.076573, 0.093795, 0.110738, 0.127400, 0.141857, 0.153763, 0.167336, 0.180483, 0.192219, 0.205076, 0.217025, 0.229967
#*# 	  -0.182286, -0.169893, -0.154934, -0.140882, -0.128696, -0.116568, -0.104158, -0.093338, -0.081187, -0.068627, -0.048343, -0.032243, -0.018831, -0.006623, 0.008923, 0.030115, 0.050340, 0.067047, 0.077666, 0.093053, 0.112637, 0.130413, 0.145087, 0.154064, 0.164654, 0.175491, 0.191429, 0.203413, 0.213314, 0.224190
#*# 	  -0.176315, -0.166773, -0.143606, -0.124116, -0.112539, -0.107247, -0.102107, -0.091464, -0.067101, -0.054409, -0.044210, -0.031681, -0.016193, 0.002266, 0.022171, 0.037608, 0.050196, 0.065522, 0.084483, 0.101857, 0.117212, 0.130803, 0.144070, 0.155713, 0.168197, 0.179232, 0.189826, 0.201813, 0.211453, 0.227366
#*# 	  -0.154853, -0.142931, -0.127896, -0.114079, -0.103335, -0.096535, -0.086221, -0.074016, -0.059317, -0.046314, -0.036577, -0.022240, -0.003387, 0.014505, 0.030541, 0.043240, 0.055283, 0.070066, 0.092855, 0.108630, 0.120065, 0.132549, 0.146128, 0.160417, 0.173153, 0.183620, 0.188441, 0.200103, 0.213078, 0.226339
#*# 	  -0.133966, -0.119779, -0.113116, -0.106319, -0.096475, -0.082410, -0.068782, -0.059205, -0.054736, -0.041342, -0.023998, -0.004924, 0.011047, 0.023268, 0.036135, 0.051546, 0.071200, 0.084350, 0.097476, 0.111737, 0.126727, 0.143739, 0.156841, 0.166580, 0.176948, 0.186376, 0.196059, 0.207348, 0.217542, 0.226037
#*# 	  -0.121844, -0.111072, -0.098186, -0.090148, -0.082735, -0.069030, -0.060151, -0.052661, -0.043841, -0.031639, -0.010705, 0.003614, 0.016825, 0.028850, 0.044374, 0.063791, 0.078816, 0.091442, 0.100766, 0.114573, 0.134037, 0.151477, 0.165204, 0.173167, 0.179686, 0.188621, 0.201442, 0.212090, 0.219673, 0.225024
#*# 	  -0.113756, -0.106292, -0.089881, -0.077863, -0.066283, -0.061839, -0.057028, -0.046623, -0.027527, -0.016043, -0.005311, 0.006995, 0.021667, 0.041456, 0.056241, 0.069845, 0.075484, 0.091990, 0.108780, 0.125562, 0.140314, 0.153622, 0.167310, 0.179313, 0.186765, 0.193721, 0.198267, 0.207227, 0.215754, 0.223519
#*# 	  -0.100337, -0.090294, -0.083476, -0.072885, -0.060571, -0.056899, -0.049430, -0.037980, -0.023519, -0.011798, -0.001616, 0.010238, 0.024859, 0.043639, 0.054953, 0.065235, 0.074100, 0.091994, 0.112862, 0.125581, 0.141192, 0.153537, 0.167623, 0.179189, 0.186970, 0.191654, 0.192773, 0.196885, 0.204715, 0.215971
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 14.0
#*# max_x = 204.0
#*# min_y = 23.0
#*# max_y = 195.0
